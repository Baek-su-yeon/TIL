# 🛠️ 문제 해결 및 트러블슈팅 (Troubleshooting)

오늘 진행한 안드로이드 및 파이썬 연동 과정에서 발생한 주요 기술적 이슈와 그 해결 방법을 기록합니다.

## 1. 안드로이드 에뮬레이터 라이브러리 미지원 이슈
가장 오랫동안 우리를 괴롭혔던 `UnsatisfiedLinkError`와 앱 강제 종료 문제입니다.

* **문제 현상**: 앱 실행 시 `libmediapipe_tasks_vision_jni.so` 파일을 찾지 못해 `java.lang.UnsatisfiedLinkError` 발생 및 즉시 종료.
* **원인**: **MediaPipe가 에뮬레이터(x86_64)를 지원하지 않습니다.** MediaPipe tasks-vision 라이브러리는 `arm64-v8a` 아키텍처만 지원하며, 에뮬레이터용 `x86_64` .so 파일이 존재하지 않습니다.
* **해결 방법**: **실제 기기(S24 등)에서 테스트를 진행해야 합니다.**
* **조치 순서**:
    1.  Android Studio → **Build** → **Clean Project**
    2.  **Build** → **Rebuild Project**
    3.  실제 안드로이드 폰을 연결한 후 **Run(▶️)** 실행
* **비고**: 에뮬레이터에서 반드시 테스트가 필요한 경우 AI 기능을 비활성화하는 분기 처리가 필요합니다.

---

## 2. IDE 및 Gradle 내부 상태 충돌
코드 수정 후에도 에러가 반복되거나 스튜디오가 멈추는 현상입니다.

* **문제 현상**: `IllegalStateException: This method is forbidden on EDT...` 로그와 함께 Gradle 동기화 및 빌드가 꼬임.
* **원인**: 안드로이드 스튜디오의 내부 캐시와 Gradle 상태가 비정상적으로 충돌함.
* **해결 방법**: **File > Invalidate Caches...** 메뉴를 통해 모든 캐시를 비우고 스튜디오를 재시작하여 해결함.

---

## 3. 제스처 판정 정확도 및 데이터 타입 이슈
추론 데이터가 실제 제어 로직에 반영될 때 발생한 문제입니다.

* **문제 현상**: 젓가락(`CHOPSTICKS`) 제스처 판정이 부정확하거나 수학 연산 중 에러 발생.
* **원인**: 단순히 모델 라벨에만 의존하여 발생한 문제이며, `Double`과 `Float` 간의 연산 불일치도 확인됨.
* **해결 방법**:
    1.  **2차 기하학 검증**: `Victory` 라벨 검출 시 손가락 끝 좌표 간의 거리를 계산하는 로직을 추가하여 판정 정밀도를 높임.
    2.  **타입 통일**: 안드로이드와 파이썬 간의 데이터 규격을 맞추기 위해 모든 좌표 및 거리 계산 단위를 **`Float`**로 통일함.

---

## 4. 포즈 트래킹 좌표계 및 임계값 인식 오류
웹캠 환경에서 사람의 위치를 판정할 때 발생한 논리적 오류입니다.

* **문제 현상**: 실수형($0.0 \sim 1.0$) 좌표로 방향을 판정할 때 직관적이지 않고 경계값이 튀는 현상.
* **원인**: 화면 해상도에 따른 물리적 위치를 고려하지 않은 단순 비율 계산 때문임.
* **해결 방법**: 정규화된 좌표를 화면 너비($w$)를 곱한 **정수형 픽셀 좌표**로 변환하고, `w // 3` 및 `(2 * w) // 3`과 같은 정수 기반 임계값을 사용하여 방향 판정의 명확성을 확보함.

---

## 5. 빌드 설정 및 라이브러리 호환성 이슈

코드 로직 이전에 앱이 아예 빌드되지 않거나 실행 직후 터지는 환경적인 문제들을 해결했습니다.

### ❌ 라이브러리 버전 충돌 (Compose Foundation)
* **문제**: 드래그 앤 드롭 기능을 위해 추가한 `reorderable` 라이브러리가 최신 Compose 환경에서 실행 시 `NoSuchMethodError`를 발생시키며 크래시됨.
* **원인**: Compose Foundation 1.7.0 버전부터 내부 메서드 구조가 변경되어 기존 라이브러리와 호환되지 않음.
* **해결**: `build.gradle.kts`에서 `androidx.compose.foundation:foundation:1.6.8` 버전을 강제로 지정하여 하위 호환성을 확보함.

### ❌ Compose 내 LiveData 인식 불가
* **문제**: `CameraPage.kt`에서 ViewModel의 LiveData를 관찰하려 할 때 `observeAsState()` 함수를 찾지 못하는 에러 발생.
* **원인**: Compose와 LiveData를 이어주는 브릿지 라이브러리가 누락됨.
* **해결**: 의존성에 `androidx.compose.runtime:runtime-livedata:1.5.4`를 추가하여 해결함.

### ❌ Gradle 중복 선언으로 인한 빌드 혼선
* **문제**: `app/build.gradle.kts` 내부에 `defaultConfig` 블록이 두 번 선언되어 특정 설정(NDK 등)이 누락되거나 덮어씌워지는 문제 발생.
* **해결**: 중복된 블록을 하나로 통합하고 NDK 아키텍처 필터를 일원화하여 빌드 구조를 정형화함.